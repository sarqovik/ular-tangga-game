<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Polana Ular Tangga vs Bot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root {
      --polana-orange: #f97316;
      --polana-dark: #020617;
      --polana-bg: radial-gradient(circle at top, #1f2937 0, #020617 45%, #000000 100%);
    }

    body {
      font-family: system-ui, sans-serif;
      background: var(--polana-bg);
      color: #e5e7eb;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      margin: 0;
      padding: 20px;
    }

    .container {
      background: rgba(2, 6, 23, 0.96);
      border-radius: 20px;
      padding: 20px;
      max-width: 960px;
      width: 100%;
      box-shadow: 0 24px 60px rgba(0,0,0,0.85),
        0 0 40px rgba(249,115,22,0.18);
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 20px;
      border: 1px solid rgba(249,115,22,0.3);
    }

    /* Header */
    .header {
      grid-column: 1 / -1;
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 4px;
    }

    h1 {
      margin: 0;
      font-size: 24px;
      color: var(--polana-orange);
      text-shadow: 0 0 10px rgba(249,115,22,0.7);
    }

    /* BOARD BACKGROUND CUSTOM IMAGE */
    .board {
      position: relative;
      display: grid;
      grid-template-columns: repeat(10, 1fr);
      gap: 0;
      background-image: url("Polana.jpg");
      background-size: cover;
      background-position: center;
      padding: 0;
      border: none;
      width: 100%;
    }

    .cell {
      position: relative;
      width: 100%;
      padding-top: 100%;
      background: transparent;
      border-radius: 0;
      overflow: hidden;
    }

    .cell-inner {
      position: absolute;
      inset: 0;
      background: transparent;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    /* Hide number & icon snake/ladder */
    .cell-number, .cell-mark {
      display: none !important;
    }

    /* Player tokens */
    .players {
      position: absolute;
      inset: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      pointer-events: none;
    }

    .player-token {
      width: 16px;
      height: 16px;
      border-radius: 999px;
      border: 2px solid rgba(15,23,42,1);
    }

    .player1 {
      background: radial-gradient(circle, #fed7aa 0%, #f97316 60%, #ea580c 100%);
      box-shadow: 0 0 12px rgba(249,115,22,0.7);
    }

    .player2 {
      background: radial-gradient(circle, #dbeafe 0%, #38bdf8 60%, #0284c7 100%);
      box-shadow: 0 0 12px rgba(56,189,248,0.7);
    }

    /* Panel kanan */
    .panel {
      background: rgba(15,23,42,0.9);
      padding: 12px;
      border-radius: 16px;
      border: 1px solid rgba(249,115,22,0.3);
      box-shadow: inset 0 0 20px rgba(0,0,0,0.5);
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .dice-display {
      font-size: 32px;
      text-align: center;
      padding: 10px;
      background: #111827;
      border-radius: 12px;
      border: 1px solid #374151;
      margin-bottom: 4px;
    }

    button {
      padding: 10px;
      border-radius: 999px;
      background: linear-gradient(135deg, #f97316, #ea580c);
      border: none;
      color: white;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 8px 24px rgba(249,115,22,0.4);
    }

    .status {
      font-size: 13px;
      max-height: 220px;
      overflow-y: auto;
      background: #0f172a;
      padding: 8px;
      border-radius: 8px;
      border: 1px solid #1f2937;
    }

    .current-player {
      color: #fb923c;
      font-weight: bold;
      text-shadow: 0 0 10px rgba(249,115,22,0.7);
    }

    /* Footer board */
    .credit {
      text-align: center;
      font-size: 11px;
      color: #f97316;
      opacity: 0.85;
      margin-top: 6px;
      grid-column: 1 / -1;
    }

    @media (max-width: 768px) {
      .container {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<body>
  <div class="container">

    <div class="header">
      <h1>Polana Ular Tangga vs Bot</h1>
    </div>

    <!-- BOARD -->
    <div id="board" class="board"></div>

    <!-- CREDIT TEXT -->
    <div class="credit">Desain papan by sarqovik</div>

    <!-- PANEL -->
    <div class="panel">
      <h2>Status</h2>

      <div class="players-info">
        <div>Giliran: <span id="currentPlayer" class="current-player">Kamu</span></div>
      </div>

      <div class="dice-display" id="diceDisplay">ðŸŽ²</div>

      <button id="rollButton">ðŸŽ² Lempar Dadu</button>
      <button id="resetButton" style="background:#6b7280;">ðŸ”„ Reset Game</button>

      <div class="status" id="logBox"></div>
    </div>
  </div>

  <script>
    /* ================= SOUND ENGINE ================= */

    let audioCtx = null;
    function ensureAudioContext() {
      if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    }
    function beep(freq, dur, type="sine", vol=0.2) {
      ensureAudioContext();
      const o = audioCtx.createOscillator();
      const g = audioCtx.createGain();
      o.type = type;
      o.frequency.value = freq;
      g.gain.value = vol;
      o.connect(g);
      g.connect(audioCtx.destination);
      o.start();
      o.stop(audioCtx.currentTime + dur);
    }
    function diceSound() {
      ensureAudioContext();
      for (let i=0;i<5;i++){
        const t=audioCtx.currentTime + i*0.05;
        const o=audioCtx.createOscillator();
        const g=audioCtx.createGain();
        o.type="triangle";
        o.frequency.value=200+Math.random()*400;
        g.gain.setValueAtTime(0.18,t);
        g.gain.exponentialRampToValueAtTime(0.01,t+0.05);
        o.connect(g); g.connect(audioCtx.destination);
        o.start(t); o.stop(t+0.06);
      }
    }
    function ladderSound(){ [400,550,700].forEach((f,i)=>setTimeout(()=>beep(f,.12),i*110)); }
    function snakeSound(){ beep(300,.18,"sawtooth"); setTimeout(()=>beep(180,.22,"sawtooth"),160); }
    function winSound(){
      const n=[[523,.18],[587,.18],[659,.18],[784,.3]];
      n.forEach((x,i)=>setTimeout(()=>beep(x[0],x[1],"square",.25),i*200));
    }

    /* ================= GAME LOGIC ================= */

    const ladders = {2:38,7:14,8:31,15:26,21:42,28:84,36:44,51:67,71:91,78:98,87:94};
    const snakes  = {16:6,48:30,62:19,64:60,74:53,89:68,92:88,95:75,99:80};

    const boardEl = document.getElementById("board");
    const diceDisplay = document.getElementById("diceDisplay");
    const rollButton = document.getElementById("rollButton");
    const resetButton = document.getElementById("resetButton");
    const logBox = document.getElementById("logBox");
    const currentPlayerSpan = document.getElementById("currentPlayer");

    let positions=[1,1];
    let currentPlayer=0; // 0=player,1=bot
    let gameOver=false;
    let isProcessing=false;

    /* Draw board 10x10 (invisible cells but clickable area) */
    function createBoard(){
      boardEl.innerHTML="";
      for(let row=10; row>=1; row--){
        for(let col=1; col<=10; col++){
          let num;
          if(row%2===0){
            num=row*10 - (col-1);
          } else {
            num=(row-1)*10 + col;
          }
          const c=document.createElement("div");
          c.className="cell";
          c.dataset.cell=num;

          const inner=document.createElement("div");
          inner.className="cell-inner";

          const numSpan=document.createElement("span");
          numSpan.className="cell-number";
          numSpan.textContent=num;

          const mark=document.createElement("span");
          mark.className="cell-mark";
          if(ladders[num]) mark.textContent="â¤´";
          if(snakes[num]) mark.textContent="â¤µ";

          inner.appendChild(numSpan);
          inner.appendChild(mark);

          const playersDiv=document.createElement("div");
          playersDiv.className="players";
          playersDiv.dataset.players=num;

          c.appendChild(inner);
          c.appendChild(playersDiv);
          boardEl.appendChild(c);
        }
      }
    }

    function renderPlayers(){
      document.querySelectorAll(".players").forEach(p=>p.innerHTML="");
      positions.forEach((pos,i)=>{
        const target=document.querySelector('.players[data-players="'+pos+'"]');
        if(!target) return;
        const t=document.createElement("div");
        t.className="player-token "+(i===0?"player1":"player2");
        target.appendChild(t);
      });
    }

    function log(msg,win=false){
      const l=document.createElement("div");
      l.textContent=msg;
      if(win) l.style.color="#fbbf24";
      logBox.prepend(l);
    }

    function takeTurn(isBot){
      if(gameOver||isProcessing) return;
      isProcessing=true;

      diceSound();
      const dice=Math.floor(Math.random()*6)+1;
      diceDisplay.textContent=dice;

      let newPos=positions[currentPlayer]+dice;

      if(newPos>100){
        log("Lewat 100, tetap di "+positions[currentPlayer]);
        endTurn(isBot);
        return;
      }

      log((currentPlayer===0?"Kamu":"Bot")+" maju ke "+newPos);

      if(ladders[newPos]){
        log("Naik tangga ke "+ladders[newPos]);
        ladderSound();
        newPos=ladders[newPos];
      }
      else if(snakes[newPos]){
        log("Kena ular turun ke "+snakes[newPos]);
        snakeSound();
        newPos=snakes[newPos];
      }

      positions[currentPlayer]=newPos;
      renderPlayers();

      if(newPos===100){
        log((currentPlayer===0?"Kamu":"Bot")+" MENANG!",true);
        winSound();
        currentPlayerSpan.textContent="Selesai";
        gameOver=true;
        isProcessing=false;
        return;
      }

      endTurn(isBot);
    }

    function endTurn(isBot){
      currentPlayer=currentPlayer===0?1:0;
      currentPlayerSpan.textContent=currentPlayer===0?"Kamu":"Bot";
      isProcessing=false;

      if(currentPlayer===1 && !isBot){
        setTimeout(()=>takeTurn(true),700);
      }
    }

    function resetGame(){
      positions=[1,1];
      currentPlayer=0;
      gameOver=false;
      isProcessing=false;
      diceDisplay.textContent="ðŸŽ²";
      logBox.innerHTML="";
      currentPlayerSpan.textContent="Kamu";
      renderPlayers();
    }

    rollButton.onclick=()=>{
      if(gameOver) return;
      if(currentPlayer!==0){
        log("Tunggu giliran Bot...");
        return;
      }
      ensureAudioContext();
      takeTurn(false);
    };

    resetButton.onclick=()=>{
      ensureAudioContext();
      resetGame();
    };

    createBoard();
    renderPlayers();
    log("Selamat datang di Polana Ular Tangga vs Bot!");
  </script>
</body>
</html>
